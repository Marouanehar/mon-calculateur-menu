function renderConsol() {
            const tbody = document.getElementById('tableConsol'); 
            tbody.innerHTML = '';
            const b2 = JSON.parse(localStorage.getItem('blueberry_b2_v77') || '{}');
            const liv = JSON.parse(localStorage.getItem('blueberry_liv_v77') || '{}');
            
            // 1. Liste des familles présentes au Siège (Rabat)
            const rabatFamilies = [...new Set([...Object.keys(brutMatrix[2026]), ...Object.keys(brutMatrix[2025])])].sort();
            
            let sumRabatFam25 = 0, sumRabatFam26 = 0;
            let bbRabat25 = 0, bbRabat26 = 0;

            // AFFICHAGE : Familles Rabat
            rabatFamilies.forEach(fam => {
                let t25 = 0, t26 = 0;
                [2025, 2026].forEach(y => {
                    const bM = brutMatrix[y][fam] || 0;
                    const oA = orientArticleSums[y][fam] || 0;
                    const oV = orientSums[y][fam] || 0;
                    const cS = cdgSums[y][fam] || 0;
                    
                    let b2v = 0;
                    if(fam === "PATISSERIE") b2v = parseFloat(b2.pat ? b2.pat[y === 2025 ? 0 : 1] : 0) || 0;
                    if(fam === "GLACES ET SORBETS") b2v = parseFloat(b2.gla ? b2.gla[y === 2025 ? 0 : 1] : 0) || 0;
                    
                    if(y === 2025) t25 = bM - oA + oV + cS + b2v; 
                    else t26 = bM - oA + oV + cS + b2v;
                });
                
                tbody.innerHTML += createConsRow(fam, t25, t26, "Rassemblement");
                sumRabatFam25 += t25; 
                sumRabatFam26 += t26;
                
                // Accumulation pour le bloc spécifique BB RABAT
                if(BLUEBERRY_RABAT_FAMILIES.includes(fam)){
                    bbRabat25 += t25; 
                    bbRabat26 += t26;
                }
            });

            // 2. CHARIOT RABAT
            const ch25 = chariotCA[2025] + (parseFloat(b2.cha ? b2.cha[0] : 0) || 0);
            const ch26 = chariotCA[2026] + (parseFloat(b2.cha ? b2.cha[1] : 0) || 0);
            tbody.innerHTML += createConsRow("CHARIOT RABAT", ch25, ch26, "Rassemblement", "bg-orange-50 font-bold");

            // 3. TOTAL (Famille Rabat + Chariot Rabat)
            const totalRabatGlobal25 = sumRabatFam25 + ch25;
            const totalRabatGlobal26 = sumRabatFam26 + ch26;
            tbody.innerHTML += createConsRow("TOTAL (FAMILLE RABAT + CHARIOT)", totalRabatGlobal25, totalRabatGlobal26, "Calcul", "bg-blue-50 font-black border-t-2 border-blue-200");

            // 4. SITE LIVRAISON BLUEBERRY
            const lb25 = parseFloat(liv.libl ? liv.libl[0] : 0) || 0;
            const lb26 = parseFloat(liv.libl ? liv.libl[1] : 0) || 0;
            tbody.innerHTML += createConsRow("SITE LIVRAISON BLUEBERRY", lb25, lb26, "Saisie");

            // 5. SITE GLOVO
            const gl25 = parseFloat(liv.glo ? liv.glo[0] : 0) || 0;
            const gl26 = parseFloat(liv.glo ? liv.glo[1] : 0) || 0;
            tbody.innerHTML += createConsRow("SITE GLOVO", gl25, gl26, "Saisie");

            // 6. BLUEBERRY RABAT (PAT/GLA/CRE/BRU)
            tbody.innerHTML += createConsRow("BLUEBERRY RABAT (PAT/GLA/CRE/BRU)", bbRabat25, bbRabat26, "Total BB", "bg-blue-900 text-white font-black");

            // 7. SITES EXTERNES
            let totalExternes25 = 0, totalExternes26 = 0;
            SITES_LIST.forEach(s => {
                const d = globalData.filter(x => x.site === s).reduce((a, b) => ({c25: a.c25 + b.ca25, c26: a.c26 + b.ca26}), {c25: 0, c26: 0});
                if(d.c25 || d.c26) {
                    tbody.innerHTML += createConsRow(s, d.c25, d.c26, "Matrice");
                    totalExternes25 += d.c25;
                    totalExternes26 += d.c26;
                }
            });

            // 8. TOTAL DES SITES EXTERNES
            tbody.innerHTML += createConsRow("TOTAL SITES EXTERNES", totalExternes25, totalExternes26, "Calcul", "bg-slate-100 font-bold border-t border-slate-300");

            // 9. CDG (TOTAL RÉPARTI)
            let c25 = 0, c26 = 0;
            Object.values(cdgSums[2025]).forEach(v => c25 += v);
            Object.values(cdgSums[2026]).forEach(v => c26 += v);
            tbody.innerHTML += createConsRow("CDG (TOTAL RÉPARTI)", c25, c26, "CDG Rabat", "bg-indigo-50 font-bold text-indigo-800");

            // 10. TOTAL GÉNÉRAL RÉSEAU
            // Formule demandée : (famille Rabat + Chariot) + Total des sites externes
            const grandTotal25 = totalRabatGlobal25 + totalExternes25;
            const grandTotal26 = totalRabatGlobal26 + totalExternes26;

            tbody.innerHTML += `
                <tr class="bg-emerald-600 text-white font-black">
                    <td class="p-5 uppercase text-sm">TOTAL GÉNÉRAL RÉSEAU</td>
                    <td class="p-5 text-right">${f(grandTotal25)}</td>
                    <td class="p-5 text-right">${f(grandTotal26)}</td>
                    <td class="p-5 text-center">${(grandTotal25 ? ((grandTotal26 - grandTotal25) / grandTotal25 * 100) : 0).toFixed(2).replace('.', ',')}%</td>
                    <td class="p-5 text-[9px] italic opacity-60">Final</td>
                </tr>`;
        }
